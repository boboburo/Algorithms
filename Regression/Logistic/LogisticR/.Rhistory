clusplot(data1[,c(4,5,6)], clus$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
clusplot(data1[,c(4,5,6)], clus$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
clus <- kmeans(data, centers=2)
clusplot(data, clus$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
data<-as.matrix((dummy.data.frame(data1,dummy.classes=c("logical","factor","character"))))
clus <- kmeans(data, centers=2)
clusplot(data, clus$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)
dissMat2<-as.matrix(daisy(data)) #?  761693.2 is sum
nc<-NbClust(data=dissMat2, distance = "euclideain", min.nc = 2, max.nc =15,method = "kmeans", index =  "all")
nc<-NbClust(data=dissMat2, min.nc = 2, max.nc =15,method = "kmeans", index =  "all")
nc<-NbClust(data=dissMat2, min.nc = 2, max.nc =15,method = "kmeans")
data2<-as.matrix((dummy.data.frame(data1,dummy.classes=c("logical","factor","character"))))
dissMat2<-as.matrix(daisy(data2)) #?  761693.2 is sum
nc<-NbClust(data=data2,diss=dissMat2 min.nc = 2, max.nc =15,method = "kmeans")
nc<-NbClust(data=data2,diss=dissMat2, min.nc = 2, max.nc =15,method = "kmeans")
nc<-NbClust(data= data1, diss=dissMat2, min.nc = 2, max.nc =15,method = "kmeans")
nc<-NbClust(data= data2, min.nc = 2, max.nc =15,method = "kmeans")
head(data2)
isna(data1)
incompletes <- which(!complete.cases(data1))
incompletes
names(data1)
class(data1[,1])
class(data1[,2])
class(data1[,3])
class(data1[,4])
class(data1[,5])
class(data1[,6])
class(data1[,7])
class(data1[,8])
class(data1[,9])
data2<-dummy.data.frame(data1,dummy.classes=c("logical","factor","character"))
head(data1)
head(data2)
dissMat<-as.matrix(daisy(data2)) #? 11306461 is sum
nc<-NbClust(data= data2,diss=dissMat, min.nc = 2, max.nc =15,method = "kmeans")
nc<-NbClust(data= dissMat, min.nc = 2, max.nc =15,method = "kmeans")
require(devtools)
install_github('likert', 'jbryer')
require(likert)
ls("package:likert")
data(pisaitems)
type(pisaitems)
typeof(pisaitems)
class(pisaitems)
str(pisaitems)
names(pisaitems)
head(pisaitems)
write.csv(data, file = "likerbrian.csv")
write.csv(pisaitems, file = "likerbrian.csv")
johnny<-read.csv(file=" /Users/briancarter1/Desktop/johnny.csv",sep=",")
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
View(johnny)
names(johnny)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation.",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnny <- names(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation.",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
library(plyr)
johnny <- names(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation.",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny)
plot(johnnylikert)
johnnylikert <- likert(johnny)
johnny
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
library(plyr)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
library(plyr)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny)
levels(johnny)
johnny
str(johnny)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
str(johnny)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
str(johnny)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
levels(johnny$Q1)
table(johnn$Q1)
table(johnny$Q1)
johnny$Q1<-factor(johnny$Q1,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny)
levels(johnny$Q1)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnnylikert <- likert(johnny)
johnny[1:4]
johnnylikert <- likert(johnny[2:5])
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("","Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
library(plyr)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny[2:5])
summary(johnnylikert)
plot(johnnylikert)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("Agree","Disagree","Unsure","Strongly disagree","Entirely Agree"))
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny[2:5])
summary(johnnylikert)
plot(johnnylikert)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny[2:5])
summary(johnnylikert)
plot(johnnylikert)
plot(johnnylikert, centered = FALSE, wrap = 30)
plot(johnnylikert, type = "density")
plot(johnnylikert, type = "heat")
plot(johnnlikert, ordered=FALSE, group.order=names(johnnlikert) #Specify the exact order of the y-axis
plot(johnnlikert, ordered=FALSE, group.order=names(johnnlikert)) #Specify the exact order of the y-axis
plot(johnnlikert, ordered=FALSE, group.order=names(johnnylikert)) #Specify the exact order of the y-axis
plot(johnnylikert, ordered=FALSE, group.order=names(johnnylikert)) #Specify the exact order of the y-axis
plot(johnnylikert, centered=FALSE, wrap=30)
plot(johnnylikert, center=1.5, wrap=30)
plot(johnnylikert, center=2, wrap=30)
plot(johnnylikert, include.histogram=TRUE)
plot(johnnylikert, type='density', facet=FALSE)
plot(johnnylikert, type='heat', wrap=30, text.size=4)
a<-summary(johnnylikert)
write.csv(a,file=""/Users/briancarter1/Desktop/johnnylikert.csv"")
write.csv(a,file="/Users/briancarter1/Desktop/johnnylikert.csv")
plot(johnnylikert)
plot(johnnylikert, centered = FALSE, wrap = 30)
plot(johnnylikert, type = "density")
plot(johnnylikert, include.histogram=TRUE)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
table(johnny$Q3)
table(johnny$Q1)
table(johnny$Q2)
table(johnny$Q3)
table(johnny$Q4)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("Strongly Disagree","Disagree","Unsure","Agree","Entirely Agree"))
library(plyr)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny[2:5])
a<-summary(johnnylikert)
write.csv(a,file="/Users/briancarter1/Desktop/johnny/johnnylikert.csv")
plot(johnnylikert, include.histogram=TRUE)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
library(plyr)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
plot(johnnylikert, include.histogram=TRUE)
johnny<-read.csv(file="/Users/briancarter1/Desktop/johnny/johnny.csv",sep=",")
levels(johnny$Q1)
levels(johnny$Q2)
levels(johnny$Q3)
levels(johnny$Q4)
johnny$Q1<-factor(johnny$Q1,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q2<-factor(johnny$Q2,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q3<-factor(johnny$Q3,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
johnny$Q4<-factor(johnny$Q4,levels=c("Strongly disagree","Disagree","Unsure","Agree","Entirely Agree"))
library(plyr)
johnny <- rename(johnny, c(Q1 = "A difficult thing about learning science is not having any help to develop argumentation",
Q2 = "I believe learning from the peer feedback is the most suitable method of learning for me",
Q3 = "I prefer to learn scientific reasoning skills on my own rather than in a group setting",
Q4 = "Using pencast is an excellent way of learning within the classroom"))
johnnylikert <- likert(johnny[2:5])
plot(johnnylikert, include.histogram=TRUE)
plot(johnnylikert)
plot(johnnylikert, centered = FALSE, wrap = 30)
plot(johnnylikert, type = "density")
plot(johnnylikert, include.histogram=TRUE)
plot(johnnylikert, type='density', facet=FALSE)
plot(johnnylikert, type='heat', wrap=30, text.size=4)
plot(johnnylikert, type='density', facet=FALSE)
plot(johnnylikert, centered = FALSE, wrap = 30)
plot(johnnylikert, type = "density")
plot(johnnylikert, include.histogram=TRUE)
plot(johnnylikert, type='heat', wrap=30, text.size=4)
plot(johnnylikert, type='density', facet=FALSE)
plot(johnnylikert, type = "density")
install.packages("rmarkdown")
str(pisaitems)
library(Hmisc)
describe(pisaitems)
library(AER)
data(Affairs,package="AER")
mydata<-Affairs
summary(mydata)
head(mydata)
table(mydata$affairs)
#Create binary variable affairs or maybe even children
mydata$naffair[mydata$affairs>0]<-1
mydata$naffair[mydata$affairs==0]<-0
fit.reduced<-glm(naffair~ age + yearsmarried + religiousness
+ rating, data=mydata,family=binomial())
exp(coef(fit.reduced))
test.data2<-data.frame(rating=c(1,2,3,4,5), age=mean(mydata$age),
yearsmarried=mean(mydata$yearsmarried),
religiousness=mean(mydata$religiousness))
test.data2$prob<-predict(fit.reduced,newdata=test.data2,type="response")
test.data2$odds<-(test.data2$prob/(1-test.data2$prob))
test.data2$decrease<-NA
for(i in 2:nrow(test.data2)){
test.data2$decrease[i]<-1-((test.data2$odds[i-1]-test.data2$odds[i])/test.data2$odds[i-1])
}
test.data2
head(mydata)
predict(fit.reduced,type="response")
a<-predict(fit.reduced,type="response")
len(a)
length(a)
mydata$prob<-predict(fit.reduced,type="response")
head(mydata)
(0.25, 0.5, 0.75)
Pi <- c(0.25, 0.5, 0.75)
summary(fit.reduced)
LD <- (log(Pi /(1-Pi))-fit.reduced$coefficients[1])/fit.reduced$coefficients[5]
LD.summary <- data.frame(Pi , LD)
LD.summary
pi.hat <- exp(my.data$prob)/(1 + exp(my.data$prob))
pi.hat <- exp(mydata$prob)/(1 + exp(mydata$prob))
library(ggplot)
library(ggplot2)
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point()
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(jitter=0.05)
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(jitter=0.5)
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(position = position_jitter(w = 0.1, h = 0.1))
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(position = position_jitter(w = 0.1, h = 0.1)) +
geom_line(aes(y = prob),colour = "black")
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(position = position_jitter(w = 0.1, h = 0.1)) +
geom_line(aes(y = prob),colour = "black") +
geom_segment(data=LD.summary, aes(y = Pi,
xend = LD,
yend = Pi,
col = group),x = -Inf,linetype = "dashed")
LD.summary$group <- c('LD25','LD50','LD75')
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(position = position_jitter(w = 0.1, h = 0.1)) +
geom_line(aes(y = prob),colour = "black") +
geom_segment(data=LD.summary, aes(y = Pi,
xend = LD,
yend = Pi,
col = group),x = -Inf,linetype = "dashed")
ggplot(mydata,aes(x = rating, y = prob)) +
geom_point(position = position_jitter(w = 0.1, h = 0.1)) +
geom_line(aes(y = prob),colour = "black") +
geom_segment(data=LD.summary, aes(y = Pi,
xend = LD,
yend = Pi,
col = group),x = -Inf,linetype = "dashed") +
geom_segment(data=LD.summary,aes(x = LD,
xend = LD,
yend = Pi,
col = group),y = -Inf,linetype = "dashed")
groups = c(1:3,2:4)
gourps
groups
tapply(groups,groups,sum)
n=3
cube<-function(n) {sq <- function()n*n;n*sq()}
cube<-function(n) {
sq <- function()n*n;
n*sq()}
cube(2)
cube(6)
sq <- function(){n*n}
sq(2)
sq()
sq <- function(n){n*n}
sq(2)
cube<-function(n) {
n*sq()}
cube(2)
cube<-function(n) {
n*sq(n)}
cube(2)
sum(c(13:25))
library(AER)
data(Affairs,package="AER")
mydata<-Affairs
summary(mydata)
head(mydata)
mydata$naffair[mydata$affairs>0]<-1
mydata$naffair[mydata$affairs==0]<-0
table(mydata$naffair)
model<-glm(naffair~gender + age + yearsmarried + children + religiousness + education
+ occupation + rating, data=mydata,family=binomial(link="logit"))
summary(model)
fit1sw = step(model)  # Keeps all variables
?step
library(car)
vif(model)
durbinWatsonTest(mdoel)
durbinWatsonTest(model)
crPlots(model)
library(ROCR)
install.packages("ROCR")
fitpreds = predict(model,type="response")
fitpreds
fitpred = prediction(fitpreds,mydata$affairs)
?prediction
??prediction
fitpred = prediction-class(fitpreds,mydata$affairs)
library(ROCR)
fitpreds = predict(model,type="response")
fitpred = prediction(fitpreds,mydata$affairs)
mydata$affairs
mydata$naffair[mydata$affairs>0]<-1
mydata$naffair[mydata$affairs==0]<-0
mydata$affairs
mydata<-Affairs
summary(mydata)
head(mydata)
table(mydata$affairs)
#Create binary variable affairs or maybe even children
mydata$naffair[mydata$affairs>0]<-1
mydata$naffair[mydata$affairs==0]<-0
head(mydata)
table(mydata$naffair)
model<-glm(naffair~gender + age + yearsmarried + children + religiousness + education
+ occupation + rating, data=mydata,family=binomial(link="logit"))
summary(model)
library(ROCR)
fitpreds = predict(model,type="response")
fitpred = prediction(fitpreds,mydata$naffair)
fitperf = performance(fitpred,"tpr","fpr")
plot(fitperf,col="green",lwd=2,main="ROC Curve for Logistic:  Adult")
abline(a=0,b=1,lwd=2,lty=2,col="gray")
??prediction
rocplot(model)
install.packages("Deducer")
library(Deducer)
rocplot(model)
mtcars %>% compute_model_prediction(mpg ~ wt, n = 10)
library(ggvis)
data(mtcars)
mtcars %>% compute_model_prediction(mpg ~ wt, n = 10)
mtcars %>% compute_model_prediction(mpg ~ wt, n = 10, se = TRUE)
mtcars %>% group_by(cyl) %>% compute_model_prediction(mpg ~ wt, n = 10)
# compute_smooth defaults to loess
mtcars %>% compute_smooth(mpg ~ wt)
# Override model to suppress message or change approach
mtcars %>% compute_model_prediction(mpg ~ wt, n = 10, model = "loess")
mtcars %>% compute_model_prediction(mpg ~ wt, n = 10, model = "lm")
# Set the domain manually
mtcars %>%
compute_model_prediction(mpg ~ wt, n = 20, model = "lm", domain = c(0, 8))
mtcars %>% compute_model_prediction(mpg ~ wt) %>%
ggvis(~pred_, ~resp_) %>%
layer_paths()
mtcars %>% ggvis() %>%
compute_model_prediction(mpg ~ wt) %>%
layer_paths(~pred_, ~resp_)
dat <- data.frame(
d = as.POSIXct('2001-06-11 21:00', tz = 'America/New_York') + 1:10 * 100,
value = 1:10
)
dat
data <- read.csv("~/GitHub/ggvisTest/Minimum Wage - Sheet1.csv")
data <- read.csv(file="minwage.csv")
setwd("~/Desktop/GitProject/LogisticR")
data <- read.csv(file="minwage.csv")
#IMPORT GGVIS
require(ggvis)
require(reshape2)
data.without.outcomes <- data[,-2]
# ESTIMATE PROPENSITY SCORES
# fit logistic regression with interaction terms and quadratics
fullmodel <- glm(NJ.PA ~ .^2 + I(WagePre^2) + I(EmploymentPre^2),data.without.outcomes,family="binomial")
ps.model <- step(fullmodel,
scope = list(lower = ~EmploymentPre+WagePre+BurgerKing+KFC+Roys, upper = ~.))
ps <- predict(ps.model, type="response") #gets the propensity scores for each unit, based on the model
data.without.outcomes <- cbind(data.without.outcomes,ps, treatment = ifelse(data.without.outcomes$NJ.PA==1,"New Jersey","Pennsylvania"))
subset(data.without.outcomes, subset = NJ.PA==0)  %>% ggvis(~ps)%>% layer_densities(stroke := "blue", fill := "none")%>%add_data(subset(data.without.outcomes, subset = NJ.PA==1)) %>% layer_densities(stroke :="red", fill := "none")
ggvis(data=data.without.outcomes, x = ~ps) %>% group_by(treatment) %>% layer_densities(fill := "none", stroke = ~treatment)
data.trimmed=trimIterate(ps.model,data,data$NJ.PA)
# OBTAIN NEW PROPENSITY SCORE ESTIMATES
data.trimmed.model = glm(formula(ps.model),data.trimmed,family="binomial")
ps.trimmed = predict(data.trimmed.model)
# REBIND PROPENSITY SCORES AND TREATMENT INDICATOR TO DATA
data.trimmed <- cbind(data.trimmed,ps = ps.trimmed, treatment = ifelse(data.trimmed$NJ.PA==1,"New Jersey","Pennsylvania"))
ggvis(data=data.trimmed, x = ~ps) %>%
group_by(treatment) %>%
layer_densities(fill := "none", stroke = ~treatment) %>%
add_axis("x", title = "Linear Propensity Scores")
data.trimmed <- cbind(data.trimmed,ps = ps.trimmed, treatment = ifelse(data.trimmed$NJ.PA==1,"New Jersey","Pennsylvania"))
data.trimmed=trimIterate(ps.model,data,data$NJ.PA)
# OBTAIN NEW PROPENSITY SCORE ESTIMATES
data.trimmed.model = glm(formula(ps.model),data.trimmed,family="binomial")
ps.trimmed = predict(data.trimmed.model)
# REBIND PROPENSITY SCORES AND TREATMENT INDICATOR TO DATA
data.trimmed <- cbind(data.trimmed,ps = ps.trimmed, treatment = ifelse(data.trimmed$NJ.PA==1,"New Jersey","Pennsylvania"))
ggvis(data=data.without.outcomes, x = ~ps) %>% group_by(treatment) %>% layer_densities(fill := "none", stroke = ~treatment)
data.trimmed=trimIterate(ps.model,data,data$NJ.PA)
??trimIterate
source("utility.R")
data.trimmed=trimIterate(ps.model,data,data$NJ.PA)
# OBTAIN NEW PROPENSITY SCORE ESTIMATES
data.trimmed.model = glm(formula(ps.model),data.trimmed,family="binomial")
ps.trimmed = predict(data.trimmed.model)
# REBIND PROPENSITY SCORES AND TREATMENT INDICATOR TO DATA
data.trimmed <- cbind(data.trimmed,ps = ps.trimmed, treatment = ifelse(data.trimmed$NJ.PA==1,"New Jersey","Pennsylvania"))
ggvis(data=data.trimmed, x = ~ps) %>%
group_by(treatment) %>%
layer_densities(fill := "none", stroke = ~treatment) %>%
add_axis("x", title = "Linear Propensity Scores")
selectedData <- input_select(choices=c("Untrimmed Data" = data.without.outcomes, "Trimmed Data" = data.trimmed))
cbind(data.trimmed[,c("treatment","ps")],id="trimmed")
ggvis(data=data.trimmed, x = ~ps) %>%
group_by(treatment) %>%
layer_densities(fill := "none", stroke = ~treatment) %>%
add_axis("x", title = "Linear Propensity Scores")
